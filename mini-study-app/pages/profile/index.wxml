<view class="profile-page">
  <!-- é¡¶éƒ¨è¿”å›æ  -->
  <view class="top-bar">
    <view class="back-button" bindtap="goBack">
      <text>â†</text>
    </view>
    <view class="top-title">æˆ‘çš„</view>
    <view class="top-placeholder"></view>
  </view>

  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card" wx:if="{{user.id}}">
    <view class="user-header">
      <view class="user-avatar">{{user.name ? user.name.charAt(0) : '?'}}</view>
      <view class="user-details">
        <view class="user-name">{{user.name}}</view>
        <view class="user-meta">
          <text class="meta-item">
            <text class="meta-icon">ğŸ†”</text>
            <text>{{user.work_no || user.username}}</text>
          </text>
          <text class="meta-item">
            <text class="meta-icon">{{user.role === 'manager' ? 'ğŸ‘”' : 'ğŸ‘¨â€ğŸ’¼'}}</text>
            <text>{{user.role === 'manager' ? 'åº—é•¿ / ç®¡ç†' : 'å‘˜å·¥'}}</text>
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç¼–è¾‘ä¿¡æ¯å¡ç‰‡ -->
  <view class="section" wx:if="{{user.id && user.role === 'employee'}}">
    <view class="info-card">
      <view class="info-item">
        <text class="info-icon">ğŸ“±</text>
        <view class="info-content">
          <view class="info-label">æ‰‹æœºå·</view>
          <view class="info-value">{{user.phone || user.mobile}}</view>
        </view>
      </view>
      <view class="info-item">
        <text class="info-icon">ğŸ‘”</text>
        <view class="info-content">
          <view class="info-label">æ‰€å±åº—é•¿</view>
          <view class="manager-tags">
            <block wx:if="{{userManagers && userManagers.length > 0}}">
              <view class="tag" wx:for="{{userManagers}}" wx:key="id">
                {{item.name || item.work_no || item.workNo}}
              </view>
            </block>
            <text wx:else class="empty-text">æš‚æ— åº—é•¿</text>
          </view>
        </view>
      </view>
      <button class="btn-edit-info" bindtap="goEditPage">ç¼–è¾‘ä¿¡æ¯</button>
    </view>
  </view>

  <view class="login-prompt" wx:if="{{!user.id}}">
    <view class="prompt-icon">ğŸ”</view>
    <view class="prompt-text">å½“å‰æœªç™»å½•</view>
    <view class="prompt-desc">è¿”å›ç™»å½•é¡µä½“éªŒå®Œæ•´åŠŸèƒ½</view>
    <button class="btn-primary" bindtap="goLogin">å‰å¾€ç™»å½•</button>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡ï¼ˆç®¡ç†å‘˜ä¸æ˜¾ç¤ºï¼‰ -->
  <view class="section" wx:if="{{user.id && user.role !== 'admin'}}">
    <view class="section-title-group">
      <text class="section-icon">ğŸ“Š</text>
      <view>
        <view class="section-title">å­¦ä¹ ç»Ÿè®¡</view>
        <view class="section-subtitle">ä½ çš„å­¦ä¹ æ•°æ®ä¸€è§ˆ</view>
      </view>
    </view>

    <view class="stats-grid" wx:if="{{stats}}">
      <view class="stat-card">
        <view class="stat-icon">âœ…</view>
        <view class="stat-value">{{stats.completedCourses}}</view>
        <view class="stat-unit">/ {{stats.totalCourses}}</view>
        <view class="stat-label">å·²å®Œæˆè¯¾ç¨‹</view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸ“š</view>
        <view class="stat-value">{{stats.totalCount || 0}}</view>
        <view class="stat-unit">/ {{stats.totalCourses}}</view>
        <view class="stat-label">å·²å¼€å§‹å­¦ä¹ </view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸ“Š</view>
        <view class="stat-value">{{stats.completionRate}}</view>
        <view class="stat-unit">%</view>
        <view class="stat-label">å®Œæˆç‡</view>
      </view>
    </view>

    <view class="stat-card empty" wx:if="{{!stats}}">
      <text>æš‚æ— ç»Ÿè®¡æ•°æ®</text>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="section" wx:if="{{user.id}}">
    <view class="section-title-group">
      <text class="section-icon">âš¡</text>
      <view>
        <view class="section-title">å¿«é€Ÿæ“ä½œ</view>
      </view>
    </view>

    <view class="action-grid">
      <view class="action-card" bindtap="goLearning">
        <view class="action-icon">ğŸ“š</view>
        <view class="action-text">å­¦ä¹ ä¸­å¿ƒ</view>
      </view>
      <view class="action-card" bindtap="handleLogout">
        <view class="action-icon">ğŸšª</view>
        <view class="action-text">é€€å‡ºç™»å½•</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨ç©ºé—´ -->
  <view class="bottom-space"></view>
</view>


